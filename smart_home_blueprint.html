<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ™ºæ…§ç‡ˆæ§ç³»çµ±è¨­è¨ˆè—åœ–</title>
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Microsoft JhengHei', Arial, sans-serif;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  padding: 20px;
  min-height: 100vh;
}

.container {
  max-width: 1400px;
  margin: 0 auto;
  background: white;
  border-radius: 20px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
  overflow: hidden;
}

.header {
  background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
  color: white;
  padding: 30px;
  text-align: center;
}

.header h1 {
  font-size: 32px;
  margin-bottom: 10px;
}

.header p {
  opacity: 0.9;
  font-size: 16px;
}

.tabs {
  display: flex;
  background: #f5f5f5;
  border-bottom: 3px solid #667eea;
}

.tab {
  flex: 1;
  padding: 20px;
  text-align: center;
  cursor: pointer;
  font-weight: 600;
  font-size: 16px;
  transition: all 0.3s;
  border: none;
  background: none;
  color: #666;
}

.tab:hover {
  background: #e8e8e8;
}

.tab.active {
  background: white;
  color: #667eea;
  border-bottom: 3px solid #667eea;
  margin-bottom: -3px;
}

.content {
  padding: 40px;
}

.view {
  display: none;
}

.view.active {
  display: block;
  animation: fadeIn 0.3s;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.canvas-container {
  background: #fafafa;
  border: 2px solid #ddd;
  border-radius: 10px;
  padding: 20px;
  margin: 20px 0;
  overflow-x: auto;
}

canvas {
  display: block;
  margin: 0 auto;
  background: white;
  border-radius: 5px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.legend {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
  margin-top: 30px;
  padding: 20px;
  background: #f8f9fa;
  border-radius: 10px;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px;
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}

.legend-color {
  width: 30px;
  height: 30px;
  border-radius: 5px;
  border: 2px solid #ddd;
}

.legend-text {
  font-size: 14px;
  font-weight: 500;
}

.specs {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin: 20px 0;
}

.spec-card {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  padding: 25px;
  border-radius: 12px;
  color: white;
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.spec-card h3 {
  font-size: 18px;
  margin-bottom: 15px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.spec-card ul {
  list-style: none;
  margin-top: 10px;
}

.spec-card li {
  padding: 8px 0;
  border-bottom: 1px solid rgba(255,255,255,0.2);
  font-size: 14px;
}

.spec-card li:last-child {
  border-bottom: none;
}

.materials {
  background: #fff;
  padding: 25px;
  border-radius: 12px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  margin: 20px 0;
}

.materials h3 {
  color: #667eea;
  font-size: 20px;
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.material-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
  margin-top: 15px;
}

.material-item {
  padding: 15px;
  background: #f8f9fa;
  border-radius: 8px;
  border-left: 4px solid #667eea;
}

.material-item strong {
  display: block;
  color: #2c3e50;
  margin-bottom: 5px;
}

.material-item span {
  color: #666;
  font-size: 14px;
}

.download-btn {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  padding: 15px 30px;
  border-radius: 10px;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  margin: 20px 10px;
  transition: all 0.3s;
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
}

.download-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
}

.note {
  background: #fff3cd;
  border-left: 4px solid #ffc107;
  padding: 20px;
  border-radius: 8px;
  margin: 20px 0;
}

.note h4 {
  color: #856404;
  margin-bottom: 10px;
  font-size: 16px;
}

.note p {
  color: #856404;
  font-size: 14px;
  line-height: 1.6;
}

@media (max-width: 768px) {
  .tabs {
    flex-direction: column;
  }
  
  .content {
    padding: 20px;
  }
}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <h1>ğŸ  æ™ºæ…§ç‡ˆæ§ç³»çµ±è¨­è¨ˆè—åœ–</h1>
    <p>å®Œæ•´çš„çµæ§‹è¨­è¨ˆã€ç·šè·¯é…ç½®èˆ‡å…ƒä»¶æ¸…å–®</p>
  </div>
  
  <div class="tabs">
    <button class="tab active" onclick="showView('structure')">ğŸ“ çµæ§‹è¨­è¨ˆ</button>
    <button class="tab" onclick="showView('wiring')">ğŸ”Œ ç·šè·¯é…ç½®</button>
    <button class="tab" onclick="showView('circuit')">âš¡ é›»è·¯åœ–</button>
    <button class="tab" onclick="showView('materials')">ğŸ“‹ å…ƒä»¶æ¸…å–®</button>
  </div>
  
  <div class="content">
    <!-- çµæ§‹è¨­è¨ˆè¦–åœ– -->
    <div id="structure" class="view active">
      <h2 style="color: #667eea; margin-bottom: 20px;">ğŸ“ ç«‹é«”çµæ§‹è¨­è¨ˆ (ä¿¯è¦–åœ–)</h2>
      
      <div class="specs">
        <div class="spec-card">
          <h3>ğŸ“ æ•´é«”å°ºå¯¸</h3>
          <ul>
            <li>é•·åº¦: 30 cm</li>
            <li>å¯¬åº¦: 25 cm</li>
            <li>é«˜åº¦: 20 cm</li>
            <li>ææ–™åšåº¦: 3-5 mm</li>
          </ul>
        </div>
        
        <div class="spec-card">
          <h3>ğŸ¡ æˆ¿é–“é…ç½®</h3>
          <ul>
            <li>ç„é—œ: 1ç‡ˆ (5Ã—5cm)</li>
            <li>å®¢å»³: 6ç‡ˆ (12Ã—10cm)</li>
            <li>å»šæˆ¿: 2ç‡ˆ (8Ã—6cm)</li>
            <li>è‡¥å®¤: 4ç‡ˆ (10Ã—8cm)</li>
            <li>æµ´å®¤: 2ç‡ˆ (6Ã—6cm)</li>
          </ul>
        </div>
        
        <div class="spec-card">
          <h3>ğŸ’¡ LEDé…ç½®</h3>
          <ul>
            <li>LED Pin 2: ç„é—œ</li>
            <li>LED Pin 4-23: å®¢å»³</li>
            <li>LED Pin 25-26: å»šæˆ¿</li>
            <li>LED Pin 27-33: è‡¥å®¤</li>
            <li>LED Pin 13-14: æµ´å®¤</li>
          </ul>
        </div>
      </div>
      
      <div class="canvas-container">
        <canvas id="structureCanvas" width="800" height="600"></canvas>
      </div>
      
      <div class="legend">
        <div class="legend-item">
          <div class="legend-color" style="background: #FFE082;"></div>
          <div class="legend-text">ç„é—œ (1ç‡ˆ)</div>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background: #90CAF9;"></div>
          <div class="legend-text">å®¢å»³ (6ç‡ˆ)</div>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background: #A5D6A7;"></div>
          <div class="legend-text">å»šæˆ¿ (2ç‡ˆ)</div>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background: #CE93D8;"></div>
          <div class="legend-text">è‡¥å®¤ (4ç‡ˆ)</div>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background: #FFAB91;"></div>
          <div class="legend-text">æµ´å®¤ (2ç‡ˆ)</div>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background: #B0BEC5;"></div>
          <div class="legend-text">é›»è·¯å€ (ESP32)</div>
        </div>
      </div>
      
      <button class="download-btn" onclick="downloadCanvas('structureCanvas', 'çµæ§‹è¨­è¨ˆåœ–.png')">
        ğŸ“¥ ä¸‹è¼‰çµæ§‹è¨­è¨ˆåœ–
      </button>
    </div>
    
    <!-- ç·šè·¯é…ç½®è¦–åœ– -->
    <div id="wiring" class="view">
      <h2 style="color: #667eea; margin-bottom: 20px;">ğŸ”Œ ç·šè·¯é…ç½®åœ–</h2>
      
      <div class="note">
        <h4>âš ï¸ é…ç·šæ³¨æ„äº‹é …</h4>
        <p>
          â€¢ ä½¿ç”¨ä¸åŒé¡è‰²ç·šæï¼šç´…è‰²(5V)ã€é»‘è‰²(GND)ã€å…¶ä»–é¡è‰²(GPIOè¨Šè™Ÿç·š)<br>
          â€¢ å»ºè­°ä¸»å¹¹ç·šä½¿ç”¨ AWG22ï¼Œåˆ†æ”¯ç·šä½¿ç”¨ AWG24-26<br>
          â€¢ æ¯å€‹LEDå¿…é ˆä¸²è¯220Î©é›»é˜»<br>
          â€¢ å»ºè­°æ¡ç”¨æ˜Ÿå½¢é…ç·šï¼Œä¾¿æ–¼ç¶­ä¿®èˆ‡æ•…éšœæ’é™¤
        </p>
      </div>
      
      <div class="canvas-container">
        <canvas id="wiringCanvas" width="900" height="700"></canvas>
      </div>
      
      <div class="legend">
        <div class="legend-item">
          <div class="legend-color" style="background: #f44336;"></div>
          <div class="legend-text">5V é›»æºç·š</div>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background: #212121;"></div>
          <div class="legend-text">GND åœ°ç·š</div>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background: #4CAF50;"></div>
          <div class="legend-text">GPIO è¨Šè™Ÿç·š</div>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background: #FFC107;"></div>
          <div class="legend-text">LED + é›»é˜»</div>
        </div>
      </div>
      
      <button class="download-btn" onclick="downloadCanvas('wiringCanvas', 'ç·šè·¯é…ç½®åœ–.png')">
        ğŸ“¥ ä¸‹è¼‰ç·šè·¯é…ç½®åœ–
      </button>
    </div>
    
    <!-- é›»è·¯åœ–è¦–åœ– -->
    <div id="circuit" class="view">
      <h2 style="color: #667eea; margin-bottom: 20px;">âš¡ é›»è·¯é€£æ¥åœ–</h2>
      
      <div class="note">
        <h4>ğŸ”§ æ¥ç·šæ­¥é©Ÿ</h4>
        <p>
          1. å…ˆå°‡ ESP32 å›ºå®šåœ¨ PCB æ¿ä¸Š<br>
          2. é€£æ¥ 5V é›»æºä¾›æ‡‰å™¨åˆ° ESP32 çš„ VIN å’Œ GND<br>
          3. å¾å„ GPIO è…³ä½æ¥å‡ºè¨Šè™Ÿç·šï¼Œç¶“é 220Î© é›»é˜»å¾Œé€£æ¥åˆ° LED æ­£æ¥µ<br>
          4. æ‰€æœ‰ LED è² æ¥µçµ±ä¸€é€£æ¥åˆ° GND<br>
          5. å»ºè­°ä½¿ç”¨ç«¯å­å°æˆ–æ’é‡æ–¹ä¾¿æ“´å……ç¶­ä¿®
        </p>
      </div>
      
      <div class="canvas-container">
        <canvas id="circuitCanvas" width="900" height="800"></canvas>
      </div>
      
      <div class="specs">
        <div class="spec-card">
          <h3>ğŸ”‹ é›»æºè¦æ ¼</h3>
          <ul>
            <li>é›»å£“: DC 5V</li>
            <li>é›»æµ: 2-3A (å»ºè­°3A)</li>
            <li>åŠŸç‡: 15W ä»¥ä¸Š</li>
            <li>ä»‹é¢: DCæ’åº§æˆ–USB-C</li>
          </ul>
        </div>
        
        <div class="spec-card">
          <h3>ğŸ’¡ LEDè¦æ ¼</h3>
          <ul>
            <li>é¡å‹: 5mm ç™½å…‰LED</li>
            <li>å·¥ä½œé›»å£“: 3.0-3.4V</li>
            <li>å·¥ä½œé›»æµ: 20mA</li>
            <li>é™æµé›»é˜»: 220Î©</li>
          </ul>
        </div>
        
        <div class="spec-card">
          <h3>ğŸ›ï¸ ESP32è¦æ ¼</h3>
          <ul>
            <li>GPIO: 15å€‹ (PWMè¼¸å‡º)</li>
            <li>PWMé »ç‡: 5000 Hz</li>
            <li>è§£æåº¦: 8-bit (0-255)</li>
            <li>å·¥ä½œé›»å£“: 3.3V/5V</li>
          </ul>
        </div>
      </div>
      
      <button class="download-btn" onclick="downloadCanvas('circuitCanvas', 'é›»è·¯é€£æ¥åœ–.png')">
        ğŸ“¥ ä¸‹è¼‰é›»è·¯é€£æ¥åœ–
      </button>
    </div>
    
    <!-- å…ƒä»¶æ¸…å–®è¦–åœ– -->
    <div id="materials" class="view">
      <h2 style="color: #667eea; margin-bottom: 20px;">ğŸ“‹ å®Œæ•´å…ƒä»¶æ¸…å–®èˆ‡æ¡è³¼æŒ‡å—</h2>
      
      <div class="materials">
        <h3>ğŸ”§ æ ¸å¿ƒé›»å­å…ƒä»¶</h3>
        <div class="material-grid">
          <div class="material-item">
            <strong>ESP32 é–‹ç™¼æ¿</strong>
            <span>æ•¸é‡: 1ç‰‡<br>åƒè€ƒåƒ¹: NT$150-250</span>
          </div>
          <div class="material-item">
            <strong>5mm LED ç‡ˆç </strong>
            <span>æ•¸é‡: 15é¡† (ç™½å…‰)<br>åƒè€ƒåƒ¹: NT$30-50</span>
          </div>
          <div class="material-item">
            <strong>220Î© é›»é˜»</strong>
            <span>æ•¸é‡: 15é¡† (1/4W)<br>åƒè€ƒåƒ¹: NT$10-20</span>
          </div>
          <div class="material-item">
            <strong>PCB æ´æ´æ¿</strong>
            <span>å°ºå¯¸: 7Ã—9 cm<br>åƒè€ƒåƒ¹: NT$30-50</span>
          </div>
        </div>
      </div>
      
      <div class="materials">
        <h3>âš¡ é›»æºèˆ‡ä¿è­·</h3>
        <div class="material-grid">
          <div class="material-item">
            <strong>5V/3A é›»æºä¾›æ‡‰å™¨</strong>
            <span>è¼¸å‡º: DC 5V 3A<br>åƒè€ƒåƒ¹: NT$100-150</span>
          </div>
          <div class="material-item">
            <strong>DC é›»æºæ’åº§</strong>
            <span>è¦æ ¼: 5.5Ã—2.1mm<br>åƒè€ƒåƒ¹: NT$10-20</span>
          </div>
          <div class="material-item">
            <strong>é›»æºé–‹é—œ</strong>
            <span>é¡å‹: æ’¥å‹•é–‹é—œ<br>åƒè€ƒåƒ¹: NT$10-15</span>
          </div>
          <div class="material-item">
            <strong>ä¿éšªçµ²åº§+ä¿éšªçµ²</strong>
            <span>è¦æ ¼: 1A å¿«ç†”<br>åƒè€ƒåƒ¹: NT$20-30</span>
          </div>
        </div>
      </div>
      
      <div class="materials">
        <h3>ğŸ”Œ é€£æ¥ç·šæ</h3>
        <div class="material-grid">
          <div class="material-item">
            <strong>æœé‚¦ç·š</strong>
            <span>å…¬å°å…¬ã€å…¬å°æ¯å„20æ¢<br>åƒè€ƒåƒ¹: NT$50-80</span>
          </div>
          <div class="material-item">
            <strong>å–®èŠ¯ç·š</strong>
            <span>AWG22/24 å„5ç±³<br>åƒè€ƒåƒ¹: NT$50-100</span>
          </div>
          <div class="material-item">
            <strong>ç†±ç¸®å¥—ç®¡</strong>
            <span>å¤šç¨®å°ºå¯¸çµ„åˆåŒ…<br>åƒè€ƒåƒ¹: NT$50-80</span>
          </div>
          <div class="material-item">
            <strong>ç«¯å­å°</strong>
            <span>2P/3P å„5å€‹<br>åƒè€ƒåƒ¹: NT$30-50</span>
          </div>
        </div>
      </div>
      
      <div class="materials">
        <h3>ğŸªµ çµæ§‹ææ–™</h3>
        <div class="material-grid">
          <div class="material-item">
            <strong>å¤¾æ¿/å¯†é›†æ¿</strong>
            <span>åšåº¦: 3-5mm<br>å°ºå¯¸: 30Ã—40cm<br>åƒè€ƒåƒ¹: NT$50-100</span>
          </div>
          <div class="material-item">
            <strong>M3 èºçµ²èºå¸½</strong>
            <span>æ•¸é‡: 20çµ„<br>åƒè€ƒåƒ¹: NT$30-50</span>
          </div>
          <div class="material-item">
            <strong>ç†±ç†”è† æ¢</strong>
            <span>æ•¸é‡: 10æ¢<br>åƒè€ƒåƒ¹: NT$30-50</span>
          </div>
          <div class="material-item">
            <strong>æŸç·šå¸¶</strong>
            <span>æ•¸é‡: 20æ¢<br>åƒè€ƒåƒ¹: NT$20-30</span>
          </div>
        </div>
      </div>
      
      <div class="materials">
        <h3>ğŸ› ï¸ å·¥å…·å»ºè­°</h3>
        <div class="material-grid">
          <div class="material-item">
            <strong>çƒ™éµçµ„</strong>
            <span>æº«æ§çƒ™éµ+ç„ŠéŒ«<br>åƒè€ƒåƒ¹: NT$300-500</span>
          </div>
          <div class="material-item">
            <strong>ç†±ç†”è† æ§</strong>
            <span>å°å‹æ‰‹æŒå¼<br>åƒè€ƒåƒ¹: NT$100-200</span>
          </div>
          <div class="material-item">
            <strong>å‰ç·šé‰—</strong>
            <span>å¤šåŠŸèƒ½å‹<br>åƒè€ƒåƒ¹: NT$100-150</span>
          </div>
          <div class="material-item">
            <strong>è¬ç”¨é›»è¡¨</strong>
            <span>æ•¸ä½å¼<br>åƒè€ƒåƒ¹: NT$200-400</span>
          </div>
        </div>
      </div>
      
      <div class="note">
        <h4>ğŸ’° é ç®—ä¼°ç®—</h4>
        <p>
          â€¢ é›»å­å…ƒä»¶: NT$400-600<br>
          â€¢ çµæ§‹ææ–™: NT$150-250<br>
          â€¢ å·¥å…· (å¦‚æœªæŒæœ‰): NT$700-1200<br>
          <strong>ç¸½è¨ˆç´„: NT$1250-2050 (ä¸å«å·¥å…·ç´„ NT$550-850)</strong>
        </p>
      </div>
      
      <div class="note" style="background: #e3f2fd; border-color: #2196f3;">
        <h4 style="color: #1565c0;">ğŸ›’ æ¨è–¦æ¡è³¼ç®¡é“</h4>
        <p style="color: #1565c0;">
          <strong>å°ç£:</strong> éœ²å¤©æ‹è³£ã€è¦çš®è³¼ç‰©ã€é£†æ©Ÿå™¨äººã€iCshop<br>
          <strong>å¯¦é«”åº—:</strong> å…‰è¯å•†å ´ã€é †ç™¼3Cã€å»ºåœ‹é›»å­ææ–™è¡—<br>
          <strong>åœ‹éš›:</strong> AliExpress (è¼ƒä¾¿å®œä½†éœ€ç­‰å¾…)<br>
          <strong>é›·åˆ‡æœå‹™:</strong> å„åœ° Maker Spaceã€FabLab æˆ–ç·šä¸Šé›·åˆ‡æœå‹™
        </p>
      </div>
    </div>
  </div>
</div>

<script>
// åˆ‡æ›è¦–åœ–
function showView(viewId) {
  document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.getElementById(viewId).classList.add('active');
  event.target.classList.add('active');
  
  // é‡æ–°ç¹ªè£½ canvas
  if (viewId === 'structure') drawStructure();
  if (viewId === 'wiring') drawWiring();
  if (viewId === 'circuit') drawCircuit();
}

// ç¹ªè£½çµæ§‹è¨­è¨ˆåœ–
function drawStructure() {
  const canvas = document.getElementById('structureCanvas');
  const ctx = canvas.getContext('2d');
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  
  // æ¯”ä¾‹å°º
  const scale = 20; // 1cm = 20px
  const offsetX = 100;
  const offsetY = 50;
  
  // ç¹ªè£½æ¨™é¡Œ
  ctx.font = 'bold 18px Microsoft JhengHei';
  ctx.fillStyle = '#2c3e50';
  ctx.fillText('ä¿¯è¦–åœ– (Top View) - å–®ä½: cm', offsetX, 30);
  
  // æˆ¿é–“å®šç¾©
  const rooms = [
    {name: 'ç„é—œ', x: 0, y: 0, w: 5, h: 5, color: '#FFE082', leds: 1, icon: 'ğŸšª'},
    {name: 'å®¢å»³', x: 6, y: 0, w: 12, h: 10, color: '#90CAF9', leds: 6, icon: 'ğŸ›‹ï¸'},
    {name: 'å»šæˆ¿', x: 19, y: 0, w: 8, h: 6, color: '#A5D6A7', leds: 2, icon: 'ğŸ³'},
    {name: 'è‡¥å®¤', x: 6, y: 11, w: 10, h: 8, color: '#CE93D8', leds: 4, icon: 'ğŸ›ï¸'},
    {name: 'æµ´å®¤', x: 17, y: 11, w: 6, h: 6, color: '#FFAB91', leds: 2, icon: 'ğŸš¿'},
    {name: 'ESP32\né›»è·¯å€', x: 0, y: 6, w: 5, h: 13, color: '#B0BEC5', leds: 0, icon: 'âš¡'}
  ];
  
  // ç¹ªè£½æˆ¿é–“
  rooms.forEach(room => {
    const x = offsetX + room.x * scale;
    const y = offsetY + room.y * scale;
    const w = room.w * scale;
    const h = room.h * scale;
    
    // å¡«å……é¡è‰²
    ctx.fillStyle = room.color;
    ctx.fillRect(x, y, w, h);
    
    // é‚Šæ¡†
    ctx.strokeStyle = '#333';
    ctx.lineWidth = 2;
    ctx.strokeRect(x, y, w, h);
    
    // æˆ¿é–“åç¨±
    ctx.fillStyle = '#333';
    ctx.font = 'bold 14px Microsoft JhengHei';
    ctx.textAlign = 'center';
    const lines = room.name.split('\n');
    lines.forEach((line, i) => {
      ctx.fillText(line, x + w/2, y + h/2 - 10 + i*18);
    });
    
    // åœ–æ¨™
    ctx.font = '20px Arial';
    ctx.fillText(room.icon, x + w/2, y + h/2 + 20);
    
    // LED æ•¸é‡
    if (room.leds > 0) {
      ctx.font = '12px Microsoft JhengHei';
      ctx.fillText(`${room.leds} ç‡ˆ`, x + w/2, y + h - 10);
      
      // ç¹ªè£½ LED ä½ç½®
      if (room.leds === 1) {
        drawLED(ctx, x + w/2, y + h/2, 6);
      } else {
        const spacing = w / (room.leds + 1);
        for (let i = 1; i <= room.leds; i++) {
          if (room.leds === 6) {
            // å®¢å»³6ç‡ˆæ’åˆ—æˆ2x3
            const row = Math.floor((i-1) / 3);
            const col = (i-1) % 3;
            drawLED(ctx, x + w/4 + col * w/3, y + h/3 + row * h/2, 6);
          } else if (room.leds === 4) {
            // è‡¥å®¤4ç‡ˆæ’åˆ—æˆ2x2
            const row = Math.floor((i-1) / 2);
            const col = (i-1) % 2;
            drawLED(ctx, x + w/3 + col * w/3, y + h/3 + row * h/2, 6);
          } else {
            drawLED(ctx, x + i * spacing, y + h/2, 6);
          }
        }
      }
    }
  });
  
  // ç¹ªè£½å°ºå¯¸æ¨™è¨»
  ctx.strokeStyle = '#666';
  ctx.lineWidth = 1;
  ctx.fillStyle = '#666';
  ctx.font = '12px Arial';
  ctx.textAlign = 'center';
  
  // å¯¬åº¦æ¨™è¨»
  drawDimension(ctx, offsetX, offsetY + 25*scale + 20, offsetX + 27*scale, offsetY + 25*scale + 20, '30 cm');
  
  // é«˜åº¦æ¨™è¨»
  ctx.save();
  ctx.translate(offsetX - 30, offsetY + 12.5*scale);
  ctx.rotate(-Math.PI/2);
  drawDimension(ctx, -12.5*scale, 0, 12.5*scale, 0, '25 cm');
  ctx.restore();
}

function drawLED(ctx, x, y, radius) {
  ctx.beginPath();
  ctx.arc(x, y, radius, 0, 2 * Math.PI);
  ctx.fillStyle = '#FFD700';
  ctx.fill();
  ctx.strokeStyle = '#FF8C00';
  ctx.lineWidth = 2;
  ctx.stroke();
}

function drawDimension(ctx, x1, y1, x2, y2, text) {
  // ç•«ç·š
  ctx.beginPath();
  ctx.moveTo(x1, y1);
  ctx.lineTo(x2, y2);
  ctx.stroke();
  
  // ç•«ç®­é ­
  const arrowSize = 8;
  ctx.beginPath();
  ctx.moveTo(x1, y1);
  ctx.lineTo(x1 + arrowSize, y1 - arrowSize/2);
  ctx.lineTo(x1 + arrowSize, y1 + arrowSize/2);
  ctx.closePath();
  ctx.fill();
  
  ctx.beginPath();
  ctx.moveTo(x2, y2);
  ctx.lineTo(x2 - arrowSize, y2 - arrowSize/2);
  ctx.lineTo(x2 - arrowSize, y2 + arrowSize/2);
  ctx.closePath();
  ctx.fill();
  
  // æ–‡å­—
  ctx.fillText(text, (x1 + x2) / 2, y1 - 5);
}

// ç¹ªè£½ç·šè·¯é…ç½®åœ–
function drawWiring() {
  const canvas = document.getElementById('wiringCanvas');
  const ctx = canvas.getContext('2d');
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  
  // æ¨™é¡Œ
  ctx.font = 'bold 18px Microsoft JhengHei';
  ctx.fillStyle = '#2c3e50';
  ctx.fillText('ç·šè·¯é…ç½®åœ– - æ˜Ÿå½¢é…ç·šæ–¹æ¡ˆ', 50, 30);
  
  // ESP32 ä½ç½®
  const esp32X = 450;
  const esp32Y = 350;
  
  // ç¹ªè£½ ESP32
  ctx.fillStyle = '#4CAF50';
  ctx.fillRect(esp32X - 50, esp32Y - 40, 100, 80);
  ctx.strokeStyle = '#2E7D32';
  ctx.lineWidth = 3;
  ctx.strokeRect(esp32X - 50, esp32Y - 40, 100, 80);
  
  ctx.fillStyle = 'white';
  ctx.font = 'bold 14px Microsoft JhengHei';
  ctx.textAlign = 'center';
  ctx.fillText('ESP32', esp32X, esp32Y - 5);
  ctx.font = '12px Microsoft JhengHei';
  ctx.fillText('é–‹ç™¼æ¿', esp32X, esp32Y + 15);
  
  // é›»æºä¾›æ‡‰å™¨
  const powerX = 150;
  const powerY = 350;
  ctx.fillStyle = '#f44336';
  ctx.fillRect(powerX - 50, powerY - 30, 100, 60);
  ctx.strokeStyle = '#c62828';
  ctx.lineWidth = 3;
  ctx.strokeRect(powerX - 50, powerY - 30, 100, 60);
  
  ctx.fillStyle = 'white';
  ctx.font = 'bold 14px Microsoft JhengHei';
  ctx.fillText('5V/3A', powerX, powerY - 5);
  ctx.font = '12px Microsoft JhengHei';
  ctx.fillText('é›»æºä¾›æ‡‰å™¨', powerX, powerY + 15);
  
  // é›»æºç·šé€£æ¥
  drawWire(ctx, powerX + 50, powerY - 15, esp32X - 50, esp32Y - 15, '#f44336', 4, '5V');
  drawWire(ctx, powerX + 50, powerY + 15, esp32X - 50, esp32Y + 15, '#212121', 4, 'GND');
  
  // LED æˆ¿é–“ä½ç½®
  const leds = [
    {room: 'ç„é—œ', x: 200, y: 100, count: 1, pins: [2]},
    {room: 'å®¢å»³', x: 450, y: 100, count: 6, pins: [4,5,18,19,21,22]},
    {room: 'å»šæˆ¿', x: 700, y: 100, count: 2, pins: [23,25]},
    {room: 'è‡¥å®¤', x: 300, y: 550, count: 4, pins: [26,27,32,33]},
    {room: 'æµ´å®¤', x: 650, y: 550, count: 2, pins: [13,14]}
  ];
  
  leds.forEach((led, idx) => {
    // ç¹ªè£½æˆ¿é–“å€åŸŸ
    ctx.fillStyle = 'rgba(102, 126, 234, 0.1)';
    ctx.fillRect(led.x - 60, led.y - 50, 120, 100);
    ctx.strokeStyle = '#667eea';
    ctx.lineWidth = 2;
    ctx.setLineDash([5, 5]);
    ctx.strokeRect(led.x - 60, led.y - 50, 120, 100);
    ctx.setLineDash([]);
    
    // æˆ¿é–“åç¨±
    ctx.fillStyle = '#667eea';
    ctx.font = 'bold 14px Microsoft JhengHei';
    ctx.textAlign = 'center';
    ctx.fillText(led.room, led.x, led.y - 30);
    
    // ç¹ªè£½ LED å’Œé€£ç·š
    const spacing = 100 / (led.count + 1);
    for (let i = 0; i < led.count; i++) {
      const ledX = led.x - 50 + (i + 1) * spacing;
      const ledY = led.y + 10;
      
      // LED ç‡ˆç 
      ctx.beginPath();
      ctx.arc(ledX, ledY, 8, 0, 2 * Math.PI);
      ctx.fillStyle = '#FFC107';
      ctx.fill();
      ctx.strokeStyle = '#F57C00';
      ctx.lineWidth = 2;
      ctx.stroke();
      
      // é›»é˜»
      ctx.fillStyle = '#8D6E63';
      ctx.fillRect(ledX - 3, ledY - 25, 6, 15);
      ctx.strokeStyle = '#5D4037';
      ctx.lineWidth = 1;
      ctx.strokeRect(ledX - 3, ledY - 25, 6, 15);
      
      // GPIO è¨Šè™Ÿç·š
      const gpioPin = led.pins[i];
      drawWire(ctx, esp32X, esp32Y - 40, ledX, ledY - 25, '#4CAF50', 2, `GPIO${gpioPin}`);
      
      // GND ç·š
      drawWire(ctx, ledX, ledY + 8, esp32X, esp32Y + 40, '#212121', 2, '');
    }
  });
  
  // åœ–ä¾‹èªªæ˜
  ctx.textAlign = 'left';
  ctx.font = '12px Microsoft JhengHei';
  
  ctx.fillStyle = '#f44336';
  ctx.fillRect(50, 600, 30, 3);
  ctx.fillStyle = '#333';
  ctx.fillText('5V é›»æºç·š', 90, 605);
  
  ctx.fillStyle = '#212121';
  ctx.fillRect(50, 630, 30, 3);
  ctx.fillStyle = '#333';
  ctx.fillText('GND åœ°ç·š', 90, 635);
  
  ctx.fillStyle = '#4CAF50';
  ctx.fillRect(50, 660, 30, 3);
  ctx.fillStyle = '#333';
  ctx.fillText('GPIO è¨Šè™Ÿç·š', 90, 665);
}

function drawWire(ctx, x1, y1, x2, y2, color, width, label) {
  ctx.strokeStyle = color;
  ctx.lineWidth = width;
  ctx.beginPath();
  ctx.moveTo(x1, y1);
  
  // ç¹ªè£½æ›²ç·š
  const midX = (x1 + x2) / 2;
  const midY = (y1 + y2) / 2;
  ctx.quadraticCurveTo(midX, y1, midX, midY);
  ctx.quadraticCurveTo(midX, y2, x2, y2);
  ctx.stroke();
  
  // æ¨™ç±¤
  if (label) {
    ctx.fillStyle = color;
    ctx.font = 'bold 10px Arial';
    ctx.textAlign = 'center';
    ctx.fillText(label, midX, midY - 5);
  }
}

// ç¹ªè£½é›»è·¯åœ–
function drawCircuit() {
  const canvas = document.getElementById('circuitCanvas');
  const ctx = canvas.getContext('2d');
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  
  // æ¨™é¡Œ
  ctx.font = 'bold 18px Microsoft JhengHei';
  ctx.fillStyle = '#2c3e50';
  ctx.textAlign = 'center';
  ctx.fillText('é›»è·¯é€£æ¥ç¤ºæ„åœ–', canvas.width / 2, 30);
  
  // ç¹ªè£½é›»æºéƒ¨åˆ†
  const powerStartX = 100;
  const powerY = 100;
  
  // AC æ’åº§
  ctx.fillStyle = '#666';
  ctx.fillRect(powerStartX, powerY, 60, 80);
  ctx.strokeStyle = '#333';
  ctx.lineWidth = 2;
  ctx.strokeRect(powerStartX, powerY, 60, 80);
  ctx.fillStyle = 'white';
  ctx.font = '12px Microsoft JhengHei';
  ctx.textAlign = 'center';
  ctx.fillText('AC', powerStartX + 30, powerY + 35);
  ctx.fillText('110V', powerStartX + 30, powerY + 55);
  
  // é–‹é—œ
  ctx.fillStyle = '#4CAF50';
  ctx.fillRect(powerStartX + 100, powerY + 20, 40, 40);
  ctx.strokeStyle = '#2E7D32';
  ctx.strokeRect(powerStartX + 100, powerY + 20, 40, 40);
  ctx.fillStyle = 'white';
  ctx.fillText('é–‹é—œ', powerStartX + 120, powerY + 45);
  
  // ä¿éšªçµ²
  ctx.strokeStyle = '#f44336';
  ctx.lineWidth = 3;
  ctx.beginPath();
  ctx.moveTo(powerStartX + 180, powerY + 40);
  ctx.lineTo(powerStartX + 240, powerY + 40);
  ctx.stroke();
  ctx.fillStyle = '#f44336';
  ctx.font = '11px Microsoft JhengHei';
  ctx.fillText('1A ä¿éšªçµ²', powerStartX + 210, powerY + 30);
  
  // é›»æºä¾›æ‡‰å™¨
  ctx.fillStyle = '#FF5722';
  ctx.fillRect(powerStartX + 260, powerY, 100, 80);
  ctx.strokeStyle = '#D84315';
  ctx.lineWidth = 2;
  ctx.strokeRect(powerStartX + 260, powerY, 100, 80);
  ctx.fillStyle = 'white';
  ctx.font = 'bold 14px Microsoft JhengHei';
  ctx.textAlign = 'center';
  ctx.fillText('é›»æºä¾›æ‡‰å™¨', powerStartX + 310, powerY + 35);
  ctx.font = '12px Microsoft JhengHei';
  ctx.fillText('DC 5V / 3A', powerStartX + 310, powerY + 55);
  
  // é€£æ¥ç·š
  ctx.strokeStyle = '#333';
  ctx.lineWidth = 2;
  ctx.beginPath();
  ctx.moveTo(powerStartX + 60, powerY + 40);
  ctx.lineTo(powerStartX + 100, powerY + 40);
  ctx.stroke();
  
  ctx.beginPath();
  ctx.moveTo(powerStartX + 140, powerY + 40);
  ctx.lineTo(powerStartX + 180, powerY + 40);
  ctx.stroke();
  
  ctx.beginPath();
  ctx.moveTo(powerStartX + 240, powerY + 40);
  ctx.lineTo(powerStartX + 260, powerY + 40);
  ctx.stroke();
  
  // ESP32 ä¸»æ¿
  const esp32X = 450;
  const esp32Y = 300;
  
  ctx.fillStyle = '#4CAF50';
  ctx.fillRect(esp32X - 80, esp32Y - 60, 160, 120);
  ctx.strokeStyle = '#2E7D32';
  ctx.lineWidth = 3;
  ctx.strokeRect(esp32X - 80, esp32Y - 60, 160, 120);
  
  ctx.fillStyle = 'white';
  ctx.font = 'bold 18px Microsoft JhengHei';
  ctx.textAlign = 'center';
  ctx.fillText('ESP32', esp32X, esp32Y - 20);
  ctx.font = '12px Microsoft JhengHei';
  ctx.fillText('é–‹ç™¼æ¿', esp32X, esp32Y + 5);
  
  // ç¹ªè£½ GPIO æ¥è…³
  const gpioPins = [
    {pin: 'VIN', y: -40, side: 'left', color: '#f44336'},
    {pin: 'GND', y: -20, side: 'left', color: '#212121'},
    {pin: 'GPIO2', y: 0, side: 'left', color: '#4CAF50'},
    {pin: 'GPIO4', y: 20, side: 'left', color: '#4CAF50'},
    {pin: 'GPIO5', y: 40, side: 'left', color: '#4CAF50'}
  ];
  
  gpioPins.forEach(pin => {
    const x = pin.side === 'left' ? esp32X - 80 : esp32X + 80;
    const y = esp32Y + pin.y;
    
    ctx.beginPath();
    ctx.arc(x, y, 4, 0, 2 * Math.PI);
    ctx.fillStyle = pin.color;
    ctx.fill();
    
    ctx.fillStyle = '#333';
    ctx.font = '10px Arial';
    ctx.textAlign = pin.side === 'left' ? 'right' : 'left';
    ctx.fillText(pin.pin, x + (pin.side === 'left' ? -10 : 10), y + 4);
  });
  
  // é›»æºé€£æ¥åˆ° ESP32
  drawCircuitWire(ctx, powerStartX + 310, powerY + 80, esp32X - 80, esp32Y - 40, '#f44336', '5V');
  drawCircuitWire(ctx, powerStartX + 310, powerY + 80, esp32X - 80, esp32Y - 20, '#212121', 'GND');
  
  // LED é›»è·¯ç¤ºä¾‹ (åªç•«3å€‹ä½œç‚ºç¤ºä¾‹)
  const ledExamples = [
    {room: 'ç„é—œ', x: 200, y: 500, pin: 'GPIO2'},
    {room: 'å®¢å»³', x: 450, y: 500, pin: 'GPIO4'},
    {room: 'å»šæˆ¿', x: 700, y: 500, pin: 'GPIO5'}
  ];
  
  ledExamples.forEach((example, idx) => {
    // GPIO é€£æ¥åˆ°é›»é˜»
    const startY = esp32Y + idx * 20;
    drawCircuitWire(ctx, esp32X - 80, startY, example.x - 40, example.y - 30, '#4CAF50', example.pin);
    
    // é›»é˜»
    ctx.fillStyle = '#8D6E63';
    ctx.fillRect(example.x - 45, example.y - 35, 10, 30);
    ctx.strokeStyle = '#5D4037';
    ctx.lineWidth = 2;
    ctx.strokeRect(example.x - 45, example.y - 35, 10, 30);
    
    ctx.fillStyle = '#333';
    ctx.font = '10px Arial';
    ctx.textAlign = 'center';
    ctx.fillText('220Î©', example.x - 40, example.y - 40);
    
    // é›»é˜»åˆ° LED
    ctx.strokeStyle = '#4CAF50';
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(example.x - 40, example.y - 5);
    ctx.lineTo(example.x - 40, example.y + 20);
    ctx.stroke();
    
    // LED
    ctx.beginPath();
    ctx.arc(example.x - 40, example.y + 30, 12, 0, 2 * Math.PI);
    ctx.fillStyle = '#FFC107';
    ctx.fill();
    ctx.strokeStyle = '#F57C00';
    ctx.lineWidth = 2;
    ctx.stroke();
    
    // LED ç¬¦è™Ÿ
    ctx.fillStyle = '#333';
    ctx.font = '16px Arial';
    ctx.textAlign = 'center';
    ctx.fillText('+', example.x - 40, example.y + 20);
    ctx.fillText('-', example.x - 40, example.y + 45);
    
    // GND é€£æ¥
    drawCircuitWire(ctx, example.x - 40, example.y + 42, esp32X - 80, esp32Y - 20, '#212121', '');
    
    // æˆ¿é–“æ¨™ç±¤
    ctx.fillStyle = '#667eea';
    ctx.font = 'bold 12px Microsoft JhengHei';
    ctx.fillText(example.room, example.x - 40, example.y + 70);
  });
  
  // å…¶é¤˜LEDæç¤º
  ctx.fillStyle = '#999';
  ctx.font = 'italic 12px Microsoft JhengHei';
  ctx.textAlign = 'center';
  ctx.fillText('... å…¶é¤˜12é¡†LEDä»¥ç›¸åŒæ–¹å¼é€£æ¥ ...', canvas.width / 2, 620);
  
  // è¨»è§£
  ctx.fillStyle = '#333';
  ctx.font = '11px Microsoft JhengHei';
  ctx.textAlign = 'left';
  ctx.fillText('â€» æ¯é¡†LEDéƒ½éœ€è¦ä¸²è¯ä¸€å€‹220Î©é›»é˜»', 50, 680);
  ctx.fillText('â€» æ‰€æœ‰LEDçš„è² æ¥µçµ±ä¸€æ¥åˆ°GND', 50, 700);
  ctx.fillText('â€» GPIOè…³ä½å°æ‡‰ç¨‹å¼ç¢¼ä¸­çš„LED_PINSé™£åˆ—', 50, 720);
  ctx.fillText('â€» å»ºè­°ä½¿ç”¨PCBæ¿æˆ–ç«¯å­å°æ•´ç†ç·šè·¯', 50, 740);
}

function drawCircuitWire(ctx, x1, y1, x2, y2, color, label) {
  ctx.strokeStyle = color;
  ctx.lineWidth = 2;
  ctx.beginPath();
  ctx.moveTo(x1, y1);
  
  // ç°¡å–®çš„ç›´ç·šæˆ–è½‰è§’
  if (Math.abs(x2 - x1) > Math.abs(y2 - y1)) {
    const midX = (x1 + x2) / 2;
    ctx.lineTo(midX, y1);
    ctx.lineTo(midX, y2);
  } else {
    const midY = (y1 + y2) / 2;
    ctx.lineTo(x1, midY);
    ctx.lineTo(x2, midY);
  }
  ctx.lineTo(x2, y2);
  ctx.stroke();
  
  if (label) {
    ctx.fillStyle = color;
    ctx.font = 'bold 9px Arial';
    ctx.textAlign = 'center';
    ctx.fillText(label, (x1 + x2) / 2, (y1 + y2) / 2 - 5);
  }
}

// ä¸‹è¼‰ Canvas åœ–ç‰‡
function downloadCanvas(canvasId, filename) {
  const canvas = document.getElementById(canvasId);
  const url = canvas.toDataURL('image/png');
  const link = document.createElement('a');
  link.download = filename;
  link.href = url;
  link.click();
}

// é é¢è¼‰å…¥æ™‚ç¹ªè£½ç¬¬ä¸€å€‹åœ–
window.onload = function() {
  drawStructure();
}
</script>
</body>
</html>